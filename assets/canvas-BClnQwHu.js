import{g as q,N as J,u as K,v as Q,R as V,r as h,t as z,d as Z,j as D}from"./index-2oVmuY96.js";const F=t=>{const{componentCls:e}=t;return{[e]:{display:"flex",flexFlow:"row wrap",minWidth:0,"&::before, &::after":{display:"flex"},"&-no-wrap":{flexWrap:"nowrap"},"&-start":{justifyContent:"flex-start"},"&-center":{justifyContent:"center"},"&-end":{justifyContent:"flex-end"},"&-space-between":{justifyContent:"space-between"},"&-space-around":{justifyContent:"space-around"},"&-space-evenly":{justifyContent:"space-evenly"},"&-top":{alignItems:"flex-start"},"&-middle":{alignItems:"center"},"&-bottom":{alignItems:"flex-end"}}}},_=t=>{const{componentCls:e}=t;return{[e]:{position:"relative",maxWidth:"100%",minHeight:1}}},ee=(t,e)=>{const{prefixCls:s,componentCls:n,gridColumns:o}=t,i={};for(let r=o;r>=0;r--)r===0?(i[`${n}${e}-${r}`]={display:"none"},i[`${n}-push-${r}`]={insetInlineStart:"auto"},i[`${n}-pull-${r}`]={insetInlineEnd:"auto"},i[`${n}${e}-push-${r}`]={insetInlineStart:"auto"},i[`${n}${e}-pull-${r}`]={insetInlineEnd:"auto"},i[`${n}${e}-offset-${r}`]={marginInlineStart:0},i[`${n}${e}-order-${r}`]={order:0}):(i[`${n}${e}-${r}`]=[{"--ant-display":"block",display:"block"},{display:"var(--ant-display)",flex:`0 0 ${r/o*100}%`,maxWidth:`${r/o*100}%`}],i[`${n}${e}-push-${r}`]={insetInlineStart:`${r/o*100}%`},i[`${n}${e}-pull-${r}`]={insetInlineEnd:`${r/o*100}%`},i[`${n}${e}-offset-${r}`]={marginInlineStart:`${r/o*100}%`},i[`${n}${e}-order-${r}`]={order:r});return i[`${n}${e}-flex`]={flex:`var(--${s}${e}-flex)`},i},B=(t,e)=>ee(t,e),te=(t,e,s)=>({[`@media (min-width: ${K(e)})`]:Object.assign({},B(t,s))}),ne=()=>({}),se=()=>({}),re=q("Grid",F,ne),oe=t=>({xs:t.screenXSMin,sm:t.screenSMMin,md:t.screenMDMin,lg:t.screenLGMin,xl:t.screenXLMin,xxl:t.screenXXLMin}),xe=q("Grid",t=>{const e=J(t,{gridColumns:24}),s=oe(e);return delete s.xs,[_(e),B(e,""),B(e,"-xs"),Object.keys(s).map(n=>te(e,s[n],`-${n}`)).reduce((n,o)=>Object.assign(Object.assign({},n),o),{})]},se),I=["xxl","xl","lg","md","sm","xs"],ie=t=>({xs:`(max-width: ${t.screenXSMax}px)`,sm:`(min-width: ${t.screenSM}px)`,md:`(min-width: ${t.screenMD}px)`,lg:`(min-width: ${t.screenLG}px)`,xl:`(min-width: ${t.screenXL}px)`,xxl:`(min-width: ${t.screenXXL}px)`}),ae=t=>{const e=t,s=[].concat(I).reverse();return s.forEach((n,o)=>{const i=n.toUpperCase(),r=`screen${i}Min`,l=`screen${i}`;if(!(e[r]<=e[l]))throw new Error(`${r}<=${l} fails : !(${e[r]}<=${e[l]})`);if(o<s.length-1){const b=`screen${i}Max`;if(!(e[l]<=e[b]))throw new Error(`${l}<=${b} fails : !(${e[l]}<=${e[b]})`);const p=`screen${s[o+1].toUpperCase()}Min`;if(!(e[b]<=e[p]))throw new Error(`${b}<=${p} fails : !(${e[b]}<=${e[p]})`)}}),t};function ce(){const[,t]=Q(),e=ie(ae(t));return V.useMemo(()=>{const s=new Map;let n=-1,o={};return{matchHandlers:{},dispatch(i){return o=i,s.forEach(r=>r(o)),s.size>=1},subscribe(i){return s.size||this.register(),n+=1,s.set(n,i),i(o),n},unsubscribe(i){s.delete(i),s.size||this.unregister()},unregister(){Object.keys(e).forEach(i=>{const r=e[i],l=this.matchHandlers[r];l==null||l.mql.removeListener(l==null?void 0:l.listener)}),s.clear()},register(){Object.keys(e).forEach(i=>{const r=e[i],l=a=>{let{matches:p}=a;this.dispatch(Object.assign(Object.assign({},o),{[i]:p}))},b=window.matchMedia(r);b.addListener(l),this.matchHandlers[r]={mql:b,listener:l},l(b)})},responsiveMap:e}},[t])}const le=h.createContext({});var ue=function(t,e){var s={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(s[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(t);o<n.length;o++)e.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(t,n[o])&&(s[n[o]]=t[n[o]]);return s};function N(t,e){const[s,n]=h.useState(typeof t=="string"?t:""),o=()=>{if(typeof t=="string"&&n(t),typeof t=="object")for(let i=0;i<I.length;i++){const r=I[i];if(!e[r])continue;const l=t[r];if(l!==void 0){n(l);return}}};return h.useEffect(()=>{o()},[JSON.stringify(t),e]),s}const ge=h.forwardRef((t,e)=>{const{prefixCls:s,justify:n,align:o,className:i,style:r,children:l,gutter:b=0,wrap:a}=t,p=ue(t,["prefixCls","justify","align","className","style","children","gutter","wrap"]),{getPrefixCls:u,direction:d}=h.useContext(z),[T,f]=h.useState({xs:!0,sm:!0,md:!0,lg:!0,xl:!0,xxl:!0}),[m,C]=h.useState({xs:!1,sm:!1,md:!1,lg:!1,xl:!1,xxl:!1}),g=N(o,m),M=N(n,m),c=h.useRef(b),x=ce();h.useEffect(()=>{const L=x.subscribe(k=>{C(k);const v=c.current||0;(!Array.isArray(v)&&typeof v=="object"||Array.isArray(v)&&(typeof v[0]=="object"||typeof v[1]=="object"))&&f(k)});return()=>x.unsubscribe(L)},[]);const y=()=>{const L=[void 0,void 0];return(Array.isArray(b)?b:[b,void 0]).forEach((v,H)=>{if(typeof v=="object")for(let Y=0;Y<I.length;Y++){const A=I[Y];if(T[A]&&v[A]!==void 0){L[H]=v[A];break}}else L[H]=v}),L},$=u("row",s),[S,O,X]=re($),R=y(),G=Z($,{[`${$}-no-wrap`]:a===!1,[`${$}-${M}`]:M,[`${$}-${g}`]:g,[`${$}-rtl`]:d==="rtl"},i,O,X),w={},E=R[0]!=null&&R[0]>0?R[0]/-2:void 0;E&&(w.marginLeft=E,w.marginRight=E);const[P,j]=R;w.rowGap=j;const U=h.useMemo(()=>({gutter:[P,j],wrap:a}),[P,j,a]);return S(h.createElement(le.Provider,{value:U},h.createElement("div",Object.assign({},p,{className:G,style:Object.assign(Object.assign({},w),r),ref:e}),l)))}),de={"cesium-wrap":"_cesium-wrap_1v4tr_1"},fe="f4fc6e359cfa6ca8132a93326965bfbf",W="74facb0d35b1a253231ceebde1e1d421",he={AMP_KEY:fe},me=()=>[[new Cesium.WebMapTileServiceImageryProvider({url:"http://t0.tianditu.com/cva_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cva&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default.jpg&tk="+W,layer:"tdtAnnoLayer",style:"default",format:"image/jpeg",tileMatrixSetID:"GoogleMapsCompatible"})],[new Cesium.WebMapTileServiceImageryProvider({url:"http://t0.tianditu.com/cia_w/wmts?service=wmts&request=GetTile&version=1.0.0&LAYER=cia&tileMatrixSet=w&TileMatrix={TileMatrix}&TileRow={TileRow}&TileCol={TileCol}&style=default.jpg&tk="+W,layer:"tdtAnnoLayer",style:"default",format:"image/jpeg",tileMatrixSetID:"GoogleMapsCompatible"})]],be=h.memo(({onUpdate:t,onAdded:e,onDelete:s,...n})=>{const[o,i]=h.useState(),r=h.useRef(null);h.useEffect(()=>(l("cesium-container",{animation:!1,timeline:!1,infoBox:!1,fullscreenButton:!1,homeButton:!1,navigationHelpButton:!1,navigationInstructionsInitiallyVisible:!1,vrButton:!1,geocoder:!1,sceneMode:Cesium.SceneMode.SCENE2D}),()=>{var f;o==null||o.destroy(),(f=r.current)==null||f.destroy()}),[]);async function l(...f){o==null||o.destroy();const m=new Cesium.Viewer(...f);i(m),window.viewer=m,a(m),u(m),p(await b(),m),console.log("init",t==null?void 0:t(o))}async function b(){const f=await new Promise((g,M)=>{var c,x;(x=(c=navigator.geolocation)==null?void 0:c.getCurrentPosition)==null||x.call(c,g,M)}).catch(g=>g),{latitude:m,longitude:C}=(f==null?void 0:f.coords)??{};return f!=null&&f.coords?{latitude:m,longitude:C,height:5e4}:void 0}function a(f){me().forEach(m=>{f.imageryLayers.addImageryProvider(...m)})}function p(f={longitude:118.12181772772028,latitude:24.492788845905654,height:5e4},m=o){const{longitude:C,latitude:g,height:M}=f??{};m==null||m.camera.flyTo({destination:Cesium.Cartesian3.fromDegrees(C,g,M),duration:2})}function u(f){const m=new Cesium.ScreenSpaceEventHandler(f.scene.canvas);m.setInputAction(C=>{var M;const g=f.scene.pick(C.position);Cesium.defined(g)&&(g!=null&&g.id)?d(((M=g==null?void 0:g.id)==null?void 0:M.id)??(g==null?void 0:g.id),f):T(C,f)},Cesium.ScreenSpaceEventType.LEFT_CLICK),r.current=m}function d(f,m){m!=null&&m.entities.removeById(f)&&(s==null||s(f))}function T(f,m){const C=m.scene.pickPosition(f==null?void 0:f.position),g=Cesium.Cartographic.fromCartesian(C),M=Cesium.Math.toDegrees(g.longitude),c=Cesium.Math.toDegrees(g.latitude);m.entities.removeAll();const{id:x}=m.entities.add({position:Cesium.Cartesian3.fromDegrees(M,c),point:{pixelSize:10,color:Cesium.Color.RED}}),y={longitude:M,latitude:c,id:x};console.log("postion: ",y),e==null||e(y)}return D.jsx("div",{id:"cesium-container",className:de["cesium-wrap"],...n})});function ye(){const t=h.useRef(null),e=h.useRef(null),s=h.useRef({x:0,y:500,width:150,height:150,onMove:!1}),[,n]=h.useState({}),o=a=>{s.current={...s.current,...a},n({})};h.useEffect(()=>{const a=t.current;return a&&i(a),()=>b(a)},[]);function i(a){const p=a.getContext("2d");a.width=1200,a.height=800,r(a);const u={centerX:a.width/2,centerY:a.height/2,hexRadius:200,ballRadius:10,gravity:.5,airResistance:.99,rotationSpeed:.02,restitution:1.85,friction:.7},d={ballX:u.centerX,ballY:u.centerY-u.hexRadius+u.ballRadius+20,vx:2,vy:0,hexRotation:0};function T(c){c.beginPath();for(let x=0;x<6;x++){const y=d.hexRotation+x*Math.PI/3,$=u.centerX+u.hexRadius*Math.cos(y),S=u.centerY+u.hexRadius*Math.sin(y);x?c.lineTo($,S):c.moveTo($,S)}c.closePath(),c.strokeStyle="#000",c.stroke()}function f(){p&&(p.beginPath(),p.arc(d.ballX,d.ballY,u.ballRadius,0,Math.PI*2),p.fillStyle="red",p.fill())}function m(){p&&(p.lineWidth=5,p.beginPath(),p.moveTo(0+s.current.x,0+s.current.y),p.lineTo(s.current.width+s.current.x,s.current.height+s.current.y),p.stroke())}function C(c,x){const y={x:x.x-c.x,y:x.y-c.y},$={x:d.ballX-c.x,y:d.ballY-c.y},S=Math.max(0,Math.min(1,($.x*y.x+$.y*y.y)/(y.x**2+y.y**2))),O={x:c.x+S*y.x,y:c.y+S*y.y},X=d.ballX-O.x,R=d.ballY-O.y,G=Math.sqrt(X**2+R**2);if(G>u.ballRadius)return null;let w={x:y.y,y:-y.x};const E={x:(c.x+x.x)/2,y:(c.y+x.y)/2};w.x*(E.x-u.centerX)+w.y*(E.y-u.centerY)>0&&(w={x:-w.x,y:-w.y});const j=Math.sqrt(w.x**2+w.y**2);return{normal:{x:w.x/j,y:w.y/j},overlap:u.ballRadius-G}}function g(c){const x=c.normal,y=d.vx*x.x+d.vy*x.y;d.vx=(d.vx-(1+u.restitution)*y*x.x)*u.friction,d.vy=(d.vy-(1+u.restitution)*y*x.y)*u.friction,d.ballX+=x.x*c.overlap*1.1,d.ballY+=x.y*c.overlap*1.1}function M(){var x;if(!p)return;p.clearRect(0,0,a.width,a.height),d.hexRotation+=u.rotationSpeed,d.vy+=u.gravity,d.vx*=u.airResistance,d.vy*=u.airResistance,d.ballX+=d.vx,d.ballY+=d.vy;const c=[];for(let y=0;y<6;y++){const $=d.hexRotation+y*Math.PI/3;c.push({x:u.centerX+u.hexRadius*Math.cos($),y:u.centerY+u.hexRadius*Math.sin($)})}for(let y=0;y<6;y++){const $=C(c[y],c[(y+1)%6]);if($){g($);break}}T(p),f(),m(),(x=e.current)==null||x.call(e,p),requestAnimationFrame(M)}M()}function r(a){a.addEventListener("mousemove",l),a.addEventListener("mousedown",l),a.addEventListener("mouseup",l)}function l(a){const{movementX:p,movementY:u}=a??{},d=s.current;switch(a.type){case"mousedown":o({onMove:!0});break;case"mouseup":o({onMove:!1});break;case"mousemove":s.current.onMove&&o({x:d.x+p,y:d.y+u});break}}function b(a){a==null||a.removeEventListener("mousemove",l),a==null||a.removeEventListener("mousedown",l),a==null||a.removeEventListener("mouseup",l)}return D.jsx("canvas",{ref:t,style:{border:"1px solid #999",borderRadius:"5px"}})}const $e=V.memo(ye);export{$e as C,ge as R,le as a,be as b,he as c,xe as u};
